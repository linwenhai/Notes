## 函数

### 1 时间函数

| 函数                              | 描述                                                         |
| --------------------------------- | ------------------------------------------------------------ |
| curdate()                         | 返回当前日期                                                 |
| curtime()                         | 返回当前时间                                                 |
| now()                             | 回当前日期和时间，年月日时分秒                               |
| date(date)                        | 返回给定参数的日期部分                                       |
| week(date)                        | 返回给定日期是一年中第几周                                   |
| year(date)                        | 返回给定日期是那一年                                         |
| hour(time)                        | 返回给定时间的小时                                           |
| minute(time)                      | 返回给定时间的分钟                                           |
| date_format(date,fmt)             | 按fmt格式化日期date                                          |
| date_add(date,interval expr type) | 返回添加指定的时间间隔的时间，type类型：hour, minute, second, year, month, day |
| date_sub(date,INTERVAL expr type) | 返回减去指定的时间间隔的时间，type类型：hour, minute, second, year, month, day |
| datediff(date1,date2)             | 计算两日期之间相差天数                                       |
| to_days(now())                    | 返回从年份0开始到now()现在的一个天数                         |

#### 1.1 now函数

函数now()：获得当前日期+时间（date + time）。

```sql
select now();
```

> 2020-08-18 14:35:00

#### 1.2 date_format函数

DATE_FORMAT() 函数用于以不同的格式显示日期/时间数据。

语法：DATE_FORMAT(date,format)

| format参数 | 描述         |
| ---------- | ------------ |
| %Y         | 年，4 位     |
| %m         | 月 (00-12)   |
| %d         | 天 (00-31)   |
| %H         | 小时 (00-23) |
| %i         | 分钟 (00-59) |
| %S         | 秒(00-59)    |

```sql
SELECT DATE_FORMAT(NOW(),"%Y-%m-%d %H:%i:%S")
```

>2020-08-18 14:33:51

#### 1.3 date_sub函数

DATE_SUB() 函数从日期减去指定的时间间隔。

语法：DATE_SUB(date,INTERVAL expr type)

| type参数 | 描述 |
| -------- | ---- |
| MINUTE   | 分钟 |
| HOUR     | 小时 |
| DAY      | 天   |

```sql
/* 查询1分钟请求量 */
SELECT COUNT(*) FROM tb_sf_pay_req t
WHERE t.crttime >= DATE_SUB(NOW(),INTERVAL 1 MINUTE);
```

### 2 字符串函数

| 函数                  | 描述                                                         |
| --------------------- | ------------------------------------------------------------ |
| concat(S1,S1,...,Sn)  | 把传入参数连接为一个字符串                                   |
| insert(str,x,y,instr) | 把字符串str从第x位开始，y个字符长度，替换字符串instr         |
| lower(str)            | 把字符串str转换成小写                                        |
| upper(str)            | 把字符串str转换成大写                                        |
| left(str,x)           | 返回字符串str最左边的x位字符                                 |
| right(str,x)          | 返回字符串str最右边的x位字符                                 |
| lpad(str,n,pad)       | 用字符串pad对str最左边填充，填充位数为n                      |
| rpad(str,n,pad)       | 用字符串pad对str最右边填充，填充位数为n                      |
| ltrim(str)            | 去掉字符串str左侧空格                                        |
| rtrim(str)            | 去掉字符串str右侧空格                                        |
| replace(str,a,b)      | 用字符串b替字符串str中所有的字符串a                          |
| strcmp(s1,s2)         | 比较字符串s1和s2的ASCII码大小，s1大于s2返回1，相等返回0，小于返回-1 |
| trim(str)             | 去掉字符串str前后空格                                        |
| substring(str,x,y)    | 返回字符串str中第x位起，y个字符长度的字符串                  |

### 3 数值函数

| 函数          | 描述                                         |
| ------------- | -------------------------------------------- |
| abs(x)        | 返回x绝对值                                  |
| ceil(x)       | 返回大于x的最小整数                          |
| floor(x)      | 返回小于x的最大整数                          |
| mod(x,y)      | 返回x/y的模                                  |
| rand()        | 返回01内随机数，100*rand()，返回0100内随机数 |
| round(x,y)    | 返回数字x的四舍五入值，保留y位小数           |
| truncate(x,y) | 返回保留y位小数的值                          |