## 存储过程和函数

存储过程（Stored Procedure）是为了完成特定功能的SQL语句集。



### 1 创建存储过程

```sql
CREATE
    [DEFINER = { user | CURRENT_USER }]
　PROCEDURE sp_name ([proc_parameter[,...]])
    [characteristic ...] routine_body
 
proc_parameter:
    [ IN | OUT | INOUT ] param_name type
 
characteristic:
    COMMENT 'string'
  | LANGUAGE SQL
  | [NOT] DETERMINISTIC
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }
 
routine_body:
　　Valid SQL routine statement
 
[begin_label:] BEGIN
　　[statement_list]
　　　　……
END [end_label]
```



1】声明语句结束符

```sql
DELIMITER $$
或
DELIMITER //
```

2】创建存储过程

```sql
create procedure 存储过程名(参数)
create procedure demo_in_parameter(IN p_in int) 
```

3】存储过程开始和结束符号

```sql
BEGIN .... END  
```

4】变量赋值

```sql
SET @p_in=1  
```

5】变量定义

```sql
DECLARE l_int int unsigned default 4000000; 
```



例子：

```sql
---新建测试表ts1
create table ts1(playerno int(10),won int(10),lost int(10));
---插入测试数据
insert into ts1 value(6,3,1);
insert into ts1 value(57,3,0);
insert into ts1 value(8,0,3);
insert into ts1 value(27,3,2);
insert into ts1 value(112,2,3);

---创建存储过程
delimiter $$
create procedure del_no(in p_playerno int)
begin
	delete from ts1 where playerno=p_playerno;
end$$
delimiter ;

---调用存储过程
select * from ts1;
call del_no(57);
select * from ts1;
```



### 2 存储过程参数





