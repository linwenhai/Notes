## 函数

### 1 字符串函数

| 函数                  | 描述                                                         |
| --------------------- | ------------------------------------------------------------ |
| concat(S1,S1,...,Sn)  | 把传入参数连接为一个字符串                                   |
| insert(str,x,y,instr) | 把字符串str从第x位开始，y个字符长度，替换字符串instr         |
| lower(str)            | 把字符串str转换成小写                                        |
| upper(str)            | 把字符串str转换成大写                                        |
| left(str,x)           | 返回字符串str最左边的x位字符                                 |
| right(str,x)          | 返回字符串str最右边的x位字符                                 |
| lpad(str,n,pad)       | 用字符串pad对str最左边填充，填充位数为n                      |
| rpad(str,n,pad)       | 用字符串pad对str最右边填充，填充位数为n                      |
| ltrim(str)            | 去掉字符串str左侧空格                                        |
| rtrim(str)            | 去掉字符串str右侧空格                                        |
| replace(str,a,b)      | 用字符串b替字符串str中所有的字符串a                          |
| strcmp(s1,s2)         | 比较字符串s1和s2的ASCII码大小，s1大于s2返回1，相等返回0，小于返回-1 |
| trim(str)             | 去掉字符串str前后空格                                        |
| substring(str,x,y)    | 返回字符串str中第x位起，y个字符长度的字符串                  |



### 2 数值函数

| 函数          | 描述                                           |
| ------------- | ---------------------------------------------- |
| abs(x)        | 返回x绝对值                                    |
| ceil(x)       | 返回大于x的最小整数                            |
| floor(x)      | 返回小于x的最大整数                            |
| mod(x,y)      | 返回x/y的模                                    |
| rand()        | 返回0~1内随机数，100*rand()，返回0~100内随机数 |
| round(x,y)    | 返回数字x的四舍五入值，保留y位小数             |
| truncate(x,y) | 返回保留y位小数的值                            |





### 3 时间函数

| 函数                              | 描述                                                         |
| --------------------------------- | ------------------------------------------------------------ |
| curdate()                         | 返回当前日期                                                 |
| curtime()                         | 返回当前时间                                                 |
| now()                             | 回当前日期和时间，年月日时分秒                               |
| date(date)                        | 返回给定参数的日期部分                                       |
| week(date)                        | 返回给定日期是一年中第几周                                   |
| year(date)                        | 返回给定日期是那一年                                         |
| hour(time)                        | 返回给定时间的小时                                           |
| minute(time)                      | 返回给定时间的分钟                                           |
| date_format(date,fmt)             | 按fmt格式化日期date                                          |
| date_add(date,interval expr type) | 返回添加指定的时间间隔的时间，type类型：hour, minute, second, year, month, day |
| date_sub(date,INTERVAL expr type) | 返回减去指定的时间间隔的时间，type类型：hour, minute, second, year, month, day |
| datediff(date1,date2)             | 计算两日期之间相差天数                                       |
| to_days(now())                    | 返回从年份0开始到now()现在的一个天数                         |

```mysql
mysql> select curdate();
+------------+
| curdate()  |
+------------+
| 2019-09-18 |
+------------+

mysql> select curtime();
+-----------+
| curtime() |
+-----------+
| 22:49:00  |
+-----------+

mysql> select now();
+---------------------+
| now()               |
+---------------------+
| 2019-09-18 22:49:36 |
+---------------------+

mysql> select date(now());
+-------------+
| date(now()) |
+-------------+
| 2019-09-18  |
+-------------+

mysql> select week(now());
+-------------+
| week(now()) |
+-------------+
|          37 |
+-------------+

mysql> select hour(curtime());
+-----------------+
| hour(curtime()) |
+-----------------+
|              22 |
+-----------------+

mysql> select minute(curtime());
+-------------------+
| minute(curtime()) |
+-------------------+
|                53 |
+-------------------+

mysql> select date_format(now(),'%Y-%m-%d %H:%i:%S');
+----------------------------------------+
| date_format(now(),'%Y-%m-%d %H:%i:%S') |
+----------------------------------------+
| 2019-09-18 22:55:10                    |
+----------------------------------------+

mysql> select date_add(now(),interval 1 day);
+--------------------------------+
| date_add(now(),interval 1 day) |
+--------------------------------+
| 2019-09-19 22:56:28            |
+--------------------------------+
mysql> select date_add(now(),interval 30 minute);
+------------------------------------+
| date_add(now(),interval 30 minute) |
+------------------------------------+
| 2019-09-18 23:27:54                |
+------------------------------------+

mysql> select date_sub(now(),interval 1 day);
+--------------------------------+
| date_sub(now(),interval 1 day) |
+--------------------------------+
| 2019-09-17 22:58:29            |
+--------------------------------+
mysql> select date_sub(now(),interval 30 minute);
+------------------------------------+
| date_sub(now(),interval 30 minute) |
+------------------------------------+
| 2019-09-18 22:28:40                |
+------------------------------------+

mysql> select datediff('2019-01-01',now());
+------------------------------+
| datediff('2019-01-01',now()) |
+------------------------------+
|                         -260 |
+------------------------------+
```





### 4 流程函数

| 函数                                                         | 描述                                             |
| ------------------------------------------------------------ | ------------------------------------------------ |
| if(value,t,f)                                                | 如value为true，返回t值，否则返回f值              |
| ifnull(value1,value2)                                        | 如value1不为空，返回value1值，否则返回value2值   |
| case when [value1] then [result1] ... else [default] end     | 如value1为true，返回result1，否则返回default值   |
| case expr when [value1] then [result1] ... else [default] end | 如expr等于value1，返回result1，否则返回default值 |



```sql
mysql> select ename,sal,if(sal>15000,'high','row') from emp;
+-------+----------+----------------------------+
| ename | sal      | if(sal>15000,'high','row') |
+-------+----------+----------------------------+
| lin   | 20000.00 | high                       |
| zhang | 10000.00 | row                        |
| li    | 12000.00 | row                        |
| zhao  | 18000.00 | high                       |
+-------+----------+----------------------------+

mysql> select ename,sal,ifnull(sal,0) from emp;
+-------+----------+---------------+
| ename | sal      | ifnull(sal,0) |
+-------+----------+---------------+
| lin   | 20000.00 |      20000.00 |
| zhang | 10000.00 |      10000.00 |
| li    | 12000.00 |      12000.00 |
| zhao  | 18000.00 |      18000.00 |
| wu    |     NULL |          0.00 |
+-------+----------+---------------+

mysql> select ename,sal,case when sal<=15000 then 'low' else 'high' end from emp;
+-------+----------+-------------------------------------------------+
| ename | sal      | case when sal<=15000 then 'low' else 'high' end |
+-------+----------+-------------------------------------------------+
| lin   | 20000.00 | high                                            |
| zhang | 10000.00 | low                                             |
| li    | 12000.00 | low                                             |
| zhao  | 18000.00 | high                                            |
| wu    |     NULL | high                                            |
+-------+----------+-------------------------------------------------+

mysql> select ename,sal,case sal when 10000 then 'low' else 'high' end from emp;
+-------+----------+------------------------------------------------+
| ename | sal      | case sal when 10000 then 'low' else 'high' end |
+-------+----------+------------------------------------------------+
| lin   | 20000.00 | high                                           |
| zhang | 10000.00 | low                                            |
| li    | 12000.00 | high                                           |
| zhao  | 18000.00 | high                                           |
| wu    |     NULL | high                                           |
+-------+----------+------------------------------------------------+
```



### 5 其他常用函数

| 函数       | 描述               |
| ---------- | ------------------ |
| database() | 返回当前数据库名   |
| version()  | 返回当前数据库版本 |
| user()     | 返回当前登录用户   |



```sql
mysql> select database();
+------------+
| database() |
+------------+
| test1      |
+------------+

mysql> select version();
+------------+
| version()  |
+------------+
| 5.7.26-log |
+------------+

mysql> select user();
+----------------+
| user()         |
+----------------+
| root@localhost |
+----------------+
```









