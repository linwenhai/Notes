## 函数

### 1 字符串函数

常用的字符函数：

| 函数                     | 说明                                                         |
| ------------------------ | ------------------------------------------------------------ |
| ASCII(X)                 | 返回字符X的ASCII码                                           |
| CONCAT(X,Y)              | 连接字符串X和Y                                               |
| INSTR(X,STR[,START][,N)  | 从X中查找str，可以指定从start开始，也可以指定从n开始         |
| LENGTH(X)                | 返回X的长度                                                  |
| LOWER(X)                 | X转换成小写                                                  |
| UPPER(X)                 | X转换成大写                                                  |
| LTRIM(X[,TRIM_STR])      | 把X的左边截去trim_str字符串，缺省截去空格                    |
| RTRIM(X[,TRIM_STR])      | 把X的右边截去trim_str字符串，缺省截去空格                    |
| TRIM([TRIM_STR FROM]X)   | 把X的两边截去trim_str字符串，缺省截去空格                    |
| REPLACE(X,old,new)       | 在X中查找old，并替换成new                                    |
| SUBSTR(X,start[,length]) | 返回X的字串，从start处开始，截取length个字符，缺省length，默认到结尾 |

上面各函数的例子：

| 示例                                         | 示例结果   |
| -------------------------------------------- | ---------- |
| SELECT ASCII('a') FROM dual;                 | 97         |
| SELECT CONCAT('Hello','world') FROM dual;    | Helloworld |
| SELECT INSTR('Hello world','or') FROM dual;  | 8          |
| SELECT LENGTH('Hello') FROM dual;            | 5          |
| SELECT LOWER('Hello') FROM dual;             | hello      |
| SELECT UPPER('hello') FROM dual;             | HELLO      |
| SELECT LTRIM('=Hello=','=') FROM dual;       | Hello=     |
| SELECT RTRIM('=Hello=','=') FROM dual;       | =Hello     |
| SELECT TRIM('='FROM'=Hello=') FROM dual;     | Hello      |
| SELECT REPLACE('ABCDE','CD','AAA')FROM dual; | ABAAAE     |
| SELECT SUBSTR('ABCDE',2,3) FROM dual;        | BCD        |

 

### 2 数字函数

| 函数         | 说明                | 示例                    |
| ------------ | ------------------- | ----------------------- |
| ABS(X)       | X的绝对值           | ABS(-3)=3               |
| ACOS(X)      | X的反余弦           | ACOS(1)=0               |
| COS(X)       | 余弦                | COS(1)=0.54030230586814 |
| CEIL(X)      | 大于或等于X的最小值 | CEIL(5.4)=6             |
| FLOOR(X)     | 小于或等于X的最大值 | FLOOR(5.8)=5            |
| LOG(X,Y)     | X为底Y的对数        | LOG(2，4)=2             |
| MOD(X,Y)     | X除以Y的余数        | MOD(8，3)=2             |
| POWER(X,Y)   | X的Y次幂            | POWER(2，3)=8           |
| ROUND(X[,Y]) | X在第Y位四舍五入    | ROUND(3.456，2)=3.46    |
| SQRT(X)      | X的平方根           | SQRT(4)=2               |
| TRUNC(X[,Y]) | X在第Y位截断        | TRUNC(3.456，2)=3.45    |

 

### 3 日期函数

**1】ADD_MONTHS(d,n)**

在某一个日期 d 上，加上指定的月数 n，返回计算后的新日期。d 表示日期，n 表示要加的月数。

```sql
SELECT SYSDATE,add_months(SYSDATE,5) FROM dual;
输出结果：



2019/7/5 14:36:23	2019/12/5 14:36:23
```

 

**2】LAST_DAY(d)**

返回指定日期当月的最后一天。

```sql
SELECT SYSDATE,last_day(SYSDATE) FROM dual;
输出结果：



2019/7/5 14:36:44	2019/7/31 14:36:44
```

 

**3】ROUND(d[,fmt])**

返回一个以 fmt 为格式的四舍五入日期值， d是日期， fmt是格式。

- 默认为“DDD”，即月中的某一天，最靠近的天，前半天舍去，后半天作为第二天。
- fmt 为“DAY”则舍入到最近的周的周日，即上半周舍去，下半周作为下一周周日。
- fmt 为“MONTH”则舍入到某月的 1 日，即前月舍去，后半月作为下一月。
- fmt 为“YEAR”则舍入到某年的 1 月 1 日，即前半年舍去，后半年作为下一年。

```sql
SELECT SYSDATE,ROUND(SYSDATE),ROUND(SYSDATE,'day'),ROUND(SYSDATE,'month'),ROUND(SYSDATE,'year') FROM dual;
输出结果：



2019/7/5 14:35:52	2019/7/6	2019/7/7	2019/7/1	2020/1/1
```

 

4】EXTRACT(fmt FROM d)

提取日期中的特定部分。

```sql
SELECT SYSDATE "date",



       EXTRACT(YEAR FROM SYSDATE)"year",



       EXTRACT(MONTH FROM SYSDATE)"month",



       EXTRACT(DAY FROM SYSDATE)"day",



       EXTRACT(HOUR FROM SYSTIMESTAMP)"hour",



       EXTRACT(MINUTE FROM SYSTIMESTAMP)"minute",



       EXTRACT(SECOND FROM SYSTIMESTAMP)"second"



FROM dual;
输出结果：



2019/7/5 14:40:02	2019	7	5	6	40	2.485172
```

 

### 4 **转换函数**

**1】TO_CHAR(d|n[,fmt])**

把日期和数字转换为制定格式的字符串。Fmt是格式化字符串

```sql
select to_char(sysdate,'YYYY-MM-DD') from dual;



select to_char(sysdate,'YYYY-MM-DD hh24:mi:ss ') from dual;
输出结果：



2019-07-05



2019-07-05 10:53:50 
```

 

2】**TO_DATE(X,[,fmt])**

 

**3】TO_NUMBER(X,[,fmt])**

 

### 5 **其它函数**

**1】NVL(X,VALUE)**

如果X为空，返回value，否则返回X。

 

2】**NVL2(x,value1,value2)**

如果x非空，返回value1，否则返回value2

 

### 6 **聚合函数**

| 名称     | 作用           | 语法                     |
| -------- | -------------- | ------------------------ |
| AVG      | 平均值         | AVG（表达式）            |
| SUM      | 求和           | SUM(表达式)              |
| MIN、MAX | 最小值、最大值 | MIN(表达式)、MAX(表达式) |
| COUNT    | 数据统计       | COUNT（表达式）          |

 

 