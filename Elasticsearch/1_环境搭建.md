

#### 1 limits.conf

/etc/security/limits.conf

```
* soft nofile 65536
* hard nofile 65536
* soft nproc 4096
* hard nproc 4096
```



#### 2 sysctl.conf

/etc/sysctl.conf

```
vm.max_map_count=262144
```

sysctl -p



#### 3 elasticsearch.yml

```
cluster.name: sfpay-es
node.name: node-1
path.data: /app/elasticsearch/data
path.logs: /app/elasticsearch/logs
network.host: 0.0.0.0
http.port: 9200
discovery.seed_hosts: ["10.206.230.185", "10.206.230.186", "10.206.230.187"]
cluster.initial_master_nodes: ["node-1"]
```



#### 4 安全配置

1】elasticsearch.yml配置安全配置和加密通信

```
xpack.security.enabled: true
xpack.security.transport.ssl.enabled: true
xpack.security.transport.ssl.verification_mode: certificate 
xpack.security.transport.ssl.keystore.path: elastic-certificates.p12 
xpack.security.transport.ssl.truststore.path: elastic-certificates.p12 
```

2】生成证书

```shell
bin/elasticsearch-certutil ca -out config/elastic-certificates.p12 -pass ""
```

3】设置集群密码

```shell
bin/elasticsearch-setup-passwords interactive
```

4】验证

http://10.206.230.185:9200



#### 5 拷贝目录到其他节点

http://10.206.230.185:9200/_cluster/health?pretty

