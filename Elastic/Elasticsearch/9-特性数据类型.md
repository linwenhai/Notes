## 特性数据类型



### 1 地理信息

#### 1.1 geo_point类型

```bash
# 定义索引hotels，字段location类型为geo_point
PUT hotels
{
  "mappings": {
    "properties": {
      "name":{
        "type":"text"
      },
      "location":{
        "type":"geo_point"
      }
    }
  }
}

# 添加文档
PUT hotels/_doc/2
{
  "name":"Beijing Hotel",
  "location":"39.914916,116.415794"
}
```



#### 1.2 geo_shape类型

```bash
# 索引hotels添加字段
PUT hotels/_mapping
{
  "properties": {
    "area":{
      "type":"geo_shape"
    }
  }
}
```



```bash
# 添加矩形地理形状
POST hotels/_update/2
{
  "doc":{
    "area":{
      "type":"envelope",
      "coordinates":[
        [116.413301,39.915863],[116.417694,39.914528]  
      ]
    }
  }
}
```



#### 1.3 geo_shape查询

```bash
# 定义envelope矩形区域，查询该区域内的饭店
POST hotels/_search
{
  "query": {
    "geo_shape": {
      "area": {
        "shape": {
          "type": "envelope",
          "coordinates": [[116.320132,39.969936],[116.457537,39.865457]]
        },
        "relation": "within"
      }
    }
  }
}
```



#### 1.4 geo_distance查询

```bash
# 定义一个坐标，指定范围查询
POST hotels/_search
{
  "query": {
    "geo_distance":{
      "distance":"5km",
      "location":[116.403872,39.915095]
    }
  }
}
```



#### 1.5 geotile_grid聚集

geotile_grid聚集：根据区域分组

```bash
POST kibana_sample_data_flights/_search?filter_path=aggregations
{
  "aggs": {
    "origin_area": {
      "geotile_grid": {
        "field": "OriginLocation",
        "precision": 5
      }
    }
  }
}
```



#### 1.6 geo_distance聚集

geo_distance聚集：根据距离分组

```bash
POST kibana_sample_data_flights/_search?filter_path=aggregations
{
  "aggs": {
    "d_r": {
      "geo_distance": {
        "field": "OriginLocation",
        "origin": "wx4g",
        "ranges": [
          {"from": 10000,"to": 30000}
        ]
      }
    }
  }
}
```

