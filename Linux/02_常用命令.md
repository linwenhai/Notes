## 常用命令

### 1 vi命令

1】命令行模式

```shell
:q!				#不存盘退出
:wq				#存盘退出
:set number		#显示行号
```

2】编辑模式

```shell
G		#移动到文件的最后一行
gg      #光标移动到文件的第一行
```



### 2 visduo命令

```shell
visudo		#配置sudo权限
---------------------------------------------------
appdeploy   ALL=(ALL) NOPASSWD: /app/ufida/start.sh
appdeploy   ALL=(ALL) NOPASSWD: /app/ufida/stop.sh
```



### 3 curl命令

```
语法：curl [option] [url]
```

常见参数：

```
-I 仅测试HTTP头
-m 10 最多查询10s
-o /dev/null 屏蔽原有输出信息
-s silent模式，不输出任何东西
-w %{http_code} 控制额外输出
```

```shell
curl -I http://www.baidu.com                            #测试网页，查看HTTP响应头信息
curl -I -m 10 -o /dev/null -s -w %{http_code} http://www.baidu.com      #只返回响应码
curl -o /dev/null -s -w %{http_code} www.linux.com      #测试网页返回值
curl -O http://www.linux.com/hello.sh                   #下载文件
curl -O -u 用户名:密码 ftp://www.linux.com/dodo1.JPG         #通过ftp下载文件
curl -T dodo1.JPG -u 用户名:密码 ftp://www.linux.com/img/    #通过ftp上传文件
```



### 4 find命令

```shell
find /app/logs -name "*.txt"            #查找以txt结尾的文件名
find /app/logs -iname "*.txt"	        #忽略大小写
find /app/logs -type f -mtime +7        #查找7天前文件
find /app/logs -type f -size +100M      #搜索大于100MB的文件
find /app/logs -type f -name "*.log" -delete        #删除目录下所有log
find /app/logs -type f -mtime +7 -name "*.log" -exec rm -rf {} \;      #删除7天前的log
find /app/logs -type f  -exec grep -H  "10.116.39.222" {} \;    
#查找目录是否含有“10.116.39.222”内容的文件
```



### 5 xargs命令

xargs的默认命令是echo，空格是默认定界符， 默认替换符号是{} 。

```shell
ls *.log |xargs rm -rf {}		#删除目录下所有log
find . -type f -name "*.log" -print0 | xargs -0 rm -f	#删除目录下所有log
ps -ef|grep java|awk '{print $2}'|xargs kill -9			#kill所以Java进程
```



### 6 sed命令

```
语法：sed [option] 'sed command' filename
```

```
-n ：只打印模式匹配的行
-e ：直接在命令行模式上进行sed动作编辑，此为默认选项
-f ：将sed的动作写在一个文件内，用–f filename 执行filename内的sed动作
-r ：支持扩展表达式
-i ：直接修改文件内容
```

```shell
sed -n '2p' error.log				#打印第2行
sed -n '1,3p' error.log			#打印第1到第3行
sed -n '/second/p' error.log		#打印日匹配sencond字符的行
sed -n '/2019\/04\/19 03:50:55/p' error.log	#打印匹配行，使用转义符
sed -n '/03:29:59/,/03:57:16/p' error.log		#sed -n '/起始时间/,/结束时间/p' 日志文件
```

```
^   匹配行开始，如：/^sed/匹配所有以sed开头的行。
$   匹配行结束，如：/sed$/匹配所有以sed结尾的行。
[]  匹配一个指定范围内的字符。
[^] 匹配一个不在指定范围内的字符。
\   转义字符
```



### 7 awk命令

```
语法：awk '{pattern + action}' {filenames}
pattern：表示AWK在数据中查找的内容
action：	是在找到匹配内容时所执行的一系列命令
```

```shell
cat /etc/passwd |awk -F ':' '{print $1}'
```

```
$0：则表示所有域，$1表示第一个域，$n表示第n个域。
-F：指定域分隔符为':'，不指定默认每行按空格或TAB分割。
```



### 8 grep命令

```
语法：grep [选项][模式][文件]
```

```
选项：
-c	--只输出匹配行的数量
-i	--搜索时忽略大小写
-h	--查询多文件时不显示文件名
-l	--只列出符合匹配的文件名，而不列出具体的匹配行
-n	--列出所有的匹配行，并显示行号
-r	--递归搜索，包含当前目录和子目录
-v	--不包含模式的所有行
```

```shell
grep -n "certif" 1.pem	#显示匹配"certif"的所有行，并显示行号
grep -v "certif" 1.pem	#显示不匹配"certif"的所有行
grep -i "certif" 1.pem	#显示匹配"certif"的所有行，忽略大小写
grep -l "certif" *	#显示匹配"certif"的文件名，只列出符合匹配的文件名，而不列出具体的匹配行
grep -r "certif" *	#递归搜索，包含当前目录和子目录
```



### 9 wget命令

```shell
参数：
-O			#下载文件重命名
-b			#后台下载，不显示详细信息
--spider	#测试URL
-o			#输出信息保存到文件
-q			#不显示输出信息
```

```shell
wget http://www.baidu.com		# 在当前目录下载一个index.html的文件
wget -O ./ceshi.html http://www.baidu.com	# 下载index.html并重名为ceshi.html
wget -b http://www.baidu.com	# 下载时，不显示详细信息
wget --spider http://www.baidu.com		# 测试是否能正常访问
wget --tries=2 http://www.baidu.com		# 设置下载重试的次数
```



### 10 ps命令

- PID: 运行着的命令(CMD)的进程编号
- TTY: 命令所运行的位置（终端）
- TIME: 运行着的该命令所占用的CPU处理时间
- CMD: 该进程所运行的命令

```
参数：
a ：显示现行终端机下的所有进程，包括其他用户的进程
u ：以用户为主的进程状态
x ：通常与a这个参数一起使用，可列出较完整信息
-e ：显示所有进程,环境变量
-f ：做一个更为完整的输出
--no-headers ：不打印开头
```

```shell
ps aux|less
ps aux --sort=-%cpu|head -n 20		#按cpu降序排列
ps aux --sort=-rss|head -n 20		#按内存降序排列
ps -C getty		#显示一个名为getty的进程的信息
ps -f -C getty
ps -L 1213		#根据PID查看线程
ps aux --no-headers|less
```

```shell
ps aux|grep "frmweb"|awk -F ':' '{print $1}'|awk '{if($10>3600) print $2}'|xargs kill -9
```



### 11 tar命令

错误写法：

```shell
tar -zcvf tomcat.tar.gz --exclude=tomcat/logs/ --exclude=tomcat/libs/ tomcat
```



正确写法：

```shell
tar -zcvf tomcat.tar.gz --exclude=tomcat/logs --exclude=tomcat/libs tomcat
```

































